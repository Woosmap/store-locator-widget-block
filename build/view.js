(()=>{"use strict";var e={n:t=>{var o=t&&t.__esModule?()=>t.default:()=>t;return e.d(o,{a:o}),o},d:(t,o)=>{for(var r in o)e.o(o,r)&&!e.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:o[r]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};const t=window.wp.domReady;var o=e.n(t);const r=window.wp.data;function i(e,t={}){try{return JSON.parse(e)||t}catch(e){return(0,r.dispatch)("core/notices").createErrorNotice(`Error parsing conf: ${e}`,{isDismissible:!0,type:"snackbar"}),t}}function s(e=[]){return e.map((e=>({type:e.storeType||"store_type",color:e.customTyleColor||"#000",icon:{url:e.customDefaultMarkerUrl||"https://images.woosmap.com/marker-default.svg"},selectedIcon:{url:e.customSelectedMarkerUrl||"https://images.woosmap.com/marker-selected.svg"},numberedIcon:{url:e.customNumberedMarkerUrl||"https://images.woosmap.com/marker-default.svg"}})))}function a(e=[]){return e.map((e=>({propertyType:e.propertyType||"propertyType",title:{en:e.title||"title"},choices:e.choices.map((e=>({key:e.choiceKey||"choiceKey",en:e.choiceTitle||"choiceTitle",selected:e.choiceSelected||!1,hidden:e.choiceHidden||!1})))||[],innerOperator:e.innerOperator||"and"})))}class n{constructor(e){this.element=e,this.storeLocatorConfig={},this.webAppLib=e.ownerDocument.defaultView.WebApp,this.webAppLib&&this.element.dataset.apiKey&&this.init()}init(){this.createStoreLocatorWidget()}createStoreLocatorWidget(){const e=function(e){const{customMarkers:t="[]",filters:o="[]",theme:r="{}",internationalization:n="{}",woosmapView:c="{}",apiKey:l,filtersOpened:p="false",filtersCustomOrder:m="false",filtersOuterOperator:d="or"}=e,u=i(c,{tileColor:"#000",tileSize:11,breakPoint:10,initialCenter:{lat:50,lng:0},initialZoom:13,style:{default:{icon:{url:"https://images.woosmap.com/marker-default.svg"},selectedIcon:{url:"https://images.woosmap.com/marker-selected.svg"},numberedIcon:{url:"https://images.woosmap.com/marker-default.svg"}}}});return{theme:i(r,{primary_color:"#000"}),datasource:{max_responses:5,max_distance:5e4},internationalization:i(n,{lang:"en",period:"fr",unitSystem:0}),maps:{apiKey:l,provider:"woosmap"},woosmapview:{initialCenter:u.initialCenter,initialZoom:u.initialZoom,tileStyle:{color:u.tileColor,size:Number(u.tileSize),minSize:5,typeRules:s(i(t))},breakPoint:Number(u.breakPoint),style:{rules:s(i(t)),default:u.style.default}},filters:{opened:"true"===p,customOrder:"true"===m,filters:a(i(o)),outerOperator:d}}}(this.element.dataset);this.storeLocatorConfig=function(e){if(!e.maps.apiKey)throw new Error("StoreLocator configuration error: apiKey is required.");return e}(e),this.element.innerHTML="";const t=document.createElement("div");t.style="width:100%; height:100%",t.id="store-locator-widget-id",this.element.appendChild(t),this.storeLocatorWidget&&(this.storeLocatorWidget.isMobile=!1,this.storeLocatorWidget.confHandler.setInitConf(this.storeLocatorConfig)),this.storeLocatorWidget=new this.webAppLib(t.id,this.storeLocatorConfig.maps.apiKey),this.storeLocatorWidget.isMobile=!1,this.storeLocatorWidget.confHandler.setInitConf(this.storeLocatorConfig)}}o()((async()=>{const e=document.querySelector(".wp-block-woosmap-store-locator-widget-block");e&&new n(e)}))})();